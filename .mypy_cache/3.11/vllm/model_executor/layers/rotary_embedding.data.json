{".class":"MypyFile","_fullname":"vllm.model_executor.layers.rotary_embedding","future_import_flags":[],"is_partial_stub_package":false,"is_stub":false,"names":{".class":"SymbolTable","Any":{".class":"SymbolTableNode","cross_ref":"typing.Any","kind":"Gdef"},"CustomOp":{".class":"SymbolTableNode","cross_ref":"vllm.model_executor.custom_op.CustomOp","kind":"Gdef"},"DeepseekScalingRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","name":"DeepseekScalingRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,5,5,5,5,5,5],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype","extrapolation_factor","attn_factor","beta_fast","beta_slow","mscale","mscale_all_dim"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,5,5,5,5,5,5],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype","extrapolation_factor","attn_factor","beta_fast","beta_slow","mscale","mscale_all_dim"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","builtins.float","torch._C.dtype","builtins.float","builtins.float","builtins.int","builtins.int","builtins.float","builtins.float"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of DeepseekScalingRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of DeepseekScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","scaling_factor"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","scaling_factor"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","builtins.float"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of DeepseekScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"attn_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.attn_factor","name":"attn_factor","type":"builtins.float"}},"beta_fast":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.beta_fast","name":"beta_fast","type":"builtins.int"}},"beta_slow":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.beta_slow","name":"beta_slow","type":"builtins.int"}},"cos_sin_cache":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["explicit_self_type","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.cos_sin_cache","name":"cos_sin_cache","type":"torch._tensor.Tensor"}},"extrapolation_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.extrapolation_factor","name":"extrapolation_factor","type":"builtins.float"}},"forward":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.forward","name":"forward","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward of DeepseekScalingRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"mscale":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.mscale","name":"mscale","type":"builtins.float"}},"scaling_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.scaling_factor","name":"scaling_factor","type":"builtins.float"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.DeepseekScalingRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"Dict":{".class":"SymbolTableNode","cross_ref":"typing.Dict","kind":"Gdef"},"DynamicNTKScalingRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding","name":"DynamicNTKScalingRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","builtins.float","torch._C.dtype"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of DynamicNTKScalingRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of DynamicNTKScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"scaling_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding.scaling_factor","name":"scaling_factor","type":"builtins.float"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.DynamicNTKScalingRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"LinearScalingRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding","name":"LinearScalingRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factors","dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factors","dtype"],"arg_types":["vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool",{".class":"UnionType","items":[{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.float"],"uses_pep604_syntax":false},"torch._C.dtype"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of LinearScalingRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of LinearScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_scaling_factor_to_offset":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["explicit_self_type","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding._scaling_factor_to_offset","name":"_scaling_factor_to_offset","type":{".class":"Instance","args":["builtins.float","builtins.int"],"extra_attrs":null,"type_ref":"builtins.dict"}}},"scaling_factor_to_offset":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_property","is_decorated"],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding.scaling_factor_to_offset","name":"scaling_factor_to_offset","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"scaling_factor_to_offset of LinearScalingRotaryEmbedding","ret_type":{".class":"Instance","args":["builtins.float","builtins.int"],"extra_attrs":null,"type_ref":"builtins.dict"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_property","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding.scaling_factor_to_offset","name":"scaling_factor_to_offset","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"scaling_factor_to_offset of LinearScalingRotaryEmbedding","ret_type":{".class":"Instance","args":["builtins.float","builtins.int"],"extra_attrs":null,"type_ref":"builtins.dict"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"scaling_factors":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["explicit_self_type","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding.scaling_factors","name":"scaling_factors","type":{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"}}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.LinearScalingRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"List":{".class":"SymbolTableNode","cross_ref":"typing.List","kind":"Gdef"},"Llama3RotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding","name":"Llama3RotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype","scaling_factor","low_freq_factor","high_freq_factor","orig_max_position"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype","scaling_factor","low_freq_factor","high_freq_factor","orig_max_position"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","torch._C.dtype","builtins.float","builtins.float","builtins.float","builtins.int"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of Llama3RotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","base"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","base"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding",{".class":"UnionType","items":["builtins.int","builtins.float"],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of Llama3RotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"high_freq_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.high_freq_factor","name":"high_freq_factor","type":"builtins.float"}},"low_freq_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.low_freq_factor","name":"low_freq_factor","type":"builtins.float"}},"orig_max_position":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.orig_max_position","name":"orig_max_position","type":"builtins.int"}},"scaling_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.scaling_factor","name":"scaling_factor","type":"builtins.float"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.Llama3RotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"Llama4VisionRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","name":"Llama4VisionRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","torch._C.dtype"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of Llama4VisionRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of Llama4VisionRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","base"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","base"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding",{".class":"UnionType","items":["builtins.int","builtins.float"],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of Llama4VisionRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"cos_sin_cache":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["explicit_self_type","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding.cos_sin_cache","name":"cos_sin_cache","type":"torch._tensor.Tensor"}},"forward":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0],"arg_names":["self","query","key"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding.forward","name":"forward","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["self","query","key"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward of Llama4VisionRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.Llama4VisionRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"MRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","name":"MRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,1],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype","mrope_section"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,1],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype","mrope_section"],"arg_types":["vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","torch._C.dtype",{".class":"UnionType","items":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of MRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"cache_max_position_num":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.cache_max_position_num","name":"cache_max_position_num","type":"builtins.int"}},"forward":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["self","positions","query","key"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.forward","name":"forward","type":{".class":"CallableType","arg_kinds":[0,0,0,0],"arg_names":["self","positions","query","key"],"arg_types":["vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward of MRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"get_input_positions":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_static","is_decorated"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_input_positions","name":"get_input_positions","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"arg_types":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},"transformers.configuration_utils.PretrainedConfig",{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"NoneType"}],"uses_pep604_syntax":false},"builtins.int",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_input_positions of MRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_staticmethod","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_input_positions","name":"get_input_positions","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"arg_types":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},"transformers.configuration_utils.PretrainedConfig",{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"NoneType"}],"uses_pep604_syntax":false},"builtins.int",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_input_positions of MRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"get_input_positions_tensor":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_static","is_decorated"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_input_positions_tensor","name":"get_input_positions_tensor","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"arg_types":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},"transformers.configuration_utils.PretrainedConfig",{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor"],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor"],"uses_pep604_syntax":false},{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.int",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_input_positions_tensor of MRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_staticmethod","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_input_positions_tensor","name":"get_input_positions_tensor","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,1,1],"arg_names":["input_tokens","hf_config","image_grid_thw","video_grid_thw","second_per_grid_ts","context_len","seq_len"],"arg_types":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},"transformers.configuration_utils.PretrainedConfig",{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor"],"uses_pep604_syntax":false},{".class":"UnionType","items":[{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"torch._tensor.Tensor"],"uses_pep604_syntax":false},{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.int",{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_input_positions_tensor of MRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"get_next_input_positions":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_static","is_decorated"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_next_input_positions","name":"get_next_input_positions","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"arg_types":["builtins.int","builtins.int","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_next_input_positions of MRotaryEmbedding","ret_type":{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_staticmethod","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_next_input_positions","name":"get_next_input_positions","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"arg_types":["builtins.int","builtins.int","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_next_input_positions of MRotaryEmbedding","ret_type":{".class":"Instance","args":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"extra_attrs":null,"type_ref":"builtins.list"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"get_next_input_positions_tensor":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_static","is_decorated"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_next_input_positions_tensor","name":"get_next_input_positions_tensor","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"arg_types":["builtins.int","builtins.int","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_next_input_positions_tensor of MRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_staticmethod","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.get_next_input_positions_tensor","name":"get_next_input_positions_tensor","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["mrope_position_delta","context_len","seq_len"],"arg_types":["builtins.int","builtins.int","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_next_input_positions_tensor of MRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"mrope_section":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.mrope_section","name":"mrope_section","type":{".class":"UnionType","items":[{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"NoneType"}],"uses_pep604_syntax":false}}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.MRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"Optional":{".class":"SymbolTableNode","cross_ref":"typing.Optional","kind":"Gdef"},"Phi3LongRoPEScaledRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["torch.nn.modules.module.Module"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","name":"Phi3LongRoPEScaledRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,0,0,1,1],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","original_max_position_embeddings","base","is_neox_style","dtype","short_factor","long_factor","short_mscale","long_mscale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,0,0,1,1],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","original_max_position_embeddings","base","is_neox_style","dtype","short_factor","long_factor","short_mscale","long_mscale"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","torch._C.dtype",{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},{".class":"UnionType","items":["builtins.float",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.float",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of Phi3LongRoPEScaledRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["self","max_position_embeddings","rescale_factors","mscale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0,0,0,0],"arg_names":["self","max_position_embeddings","rescale_factors","mscale"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","builtins.int",{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"},"builtins.float"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of Phi3LongRoPEScaledRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","rescale_factors"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","rescale_factors"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding",{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of Phi3LongRoPEScaledRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"base":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.base","name":"base","type":"builtins.int"}},"forward":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.forward","name":"forward","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward of Phi3LongRoPEScaledRotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"head_size":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.head_size","name":"head_size","type":"builtins.int"}},"long_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.long_factor","name":"long_factor","type":{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"}}},"long_mscale":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.long_mscale","name":"long_mscale","type":"builtins.float"}},"max_position_embeddings":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.max_position_embeddings","name":"max_position_embeddings","type":"builtins.int"}},"original_max_position_embeddings":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.original_max_position_embeddings","name":"original_max_position_embeddings","type":"builtins.int"}},"rotary_dim":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.rotary_dim","name":"rotary_dim","type":"builtins.int"}},"short_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.short_factor","name":"short_factor","type":{".class":"Instance","args":["builtins.float"],"extra_attrs":null,"type_ref":"builtins.list"}}},"short_mscale":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.short_mscale","name":"short_mscale","type":"builtins.float"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.Phi3LongRoPEScaledRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"PretrainedConfig":{".class":"SymbolTableNode","cross_ref":"transformers.configuration_utils.PretrainedConfig","kind":"Gdef"},"RotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.custom_op.CustomOp"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","name":"RotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","dtype"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","torch._C.dtype"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of RotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of RotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","base"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","base"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding",{".class":"UnionType","items":["builtins.int","builtins.float"],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of RotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"base":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.base","name":"base","type":"builtins.int"}},"cos_sin_cache":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["explicit_self_type","is_ready","is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.cos_sin_cache","name":"cos_sin_cache","type":"torch._tensor.Tensor"}},"dtype":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.dtype","name":"dtype","type":"torch._C.dtype"}},"extra_repr":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.extra_repr","name":"extra_repr","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"extra_repr of RotaryEmbedding","ret_type":"builtins.str","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"forward_cuda":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.forward_cuda","name":"forward_cuda","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward_cuda of RotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"forward_hpu":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.forward_hpu","name":"forward_hpu","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward_hpu of RotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"forward_native":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.forward_native","name":"forward_native","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward_native of RotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"forward_neuron":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.forward_neuron","name":"forward_neuron","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward_neuron of RotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"forward_xpu":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.forward_xpu","name":"forward_xpu","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1],"arg_names":["self","positions","query","key","offsets"],"arg_types":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"forward_xpu of RotaryEmbedding","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"head_size":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.head_size","name":"head_size","type":"builtins.int"}},"is_neox_style":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.is_neox_style","name":"is_neox_style","type":"builtins.bool"}},"max_position_embeddings":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.max_position_embeddings","name":"max_position_embeddings","type":"builtins.int"}},"rotary_dim":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.rotary_dim","name":"rotary_dim","type":"builtins.int"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"Tuple":{".class":"SymbolTableNode","cross_ref":"typing.Tuple","kind":"Gdef"},"Union":{".class":"SymbolTableNode","cross_ref":"typing.Union","kind":"Gdef"},"YaRNScalingRotaryEmbedding":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","name":"YaRNScalingRotaryEmbedding","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.rotary_embedding","mro":["vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","vllm.model_executor.custom_op.CustomOp","torch.nn.modules.module.Module","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,5,5,5,5],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype","extrapolation_factor","attn_factor","beta_fast","beta_slow"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,0,0,0,0,0,0,0,5,5,5,5],"arg_names":["self","head_size","rotary_dim","max_position_embeddings","base","is_neox_style","scaling_factor","dtype","extrapolation_factor","attn_factor","beta_fast","beta_slow"],"arg_types":["vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool","builtins.float","torch._C.dtype","builtins.float","builtins.float","builtins.int","builtins.int"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of YaRNScalingRotaryEmbedding","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_cos_sin_cache":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding._compute_cos_sin_cache","name":"_compute_cos_sin_cache","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_cos_sin_cache of YaRNScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_compute_inv_freq":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","scaling_factor"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding._compute_inv_freq","name":"_compute_inv_freq","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["self","scaling_factor"],"arg_types":["vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","builtins.float"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_compute_inv_freq of YaRNScalingRotaryEmbedding","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"attn_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.attn_factor","name":"attn_factor","type":"builtins.float"}},"beta_fast":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.beta_fast","name":"beta_fast","type":"builtins.int"}},"beta_slow":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.beta_slow","name":"beta_slow","type":"builtins.int"}},"extrapolation_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.extrapolation_factor","name":"extrapolation_factor","type":"builtins.float"}},"mscale":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.mscale","name":"mscale","type":"builtins.float"}},"scaling_factor":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.scaling_factor","name":"scaling_factor","type":"builtins.float"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.rotary_embedding.YaRNScalingRotaryEmbedding","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"_ROPE_DICT":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready","has_explicit_value"],"fullname":"vllm.model_executor.layers.rotary_embedding._ROPE_DICT","name":"_ROPE_DICT","type":{".class":"Instance","args":[{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4}],"extra_attrs":null,"type_ref":"builtins.tuple"},"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding"],"extra_attrs":null,"type_ref":"builtins.dict"}}},"__annotations__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__annotations__","name":"__annotations__","type":{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"__doc__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__doc__","name":"__doc__","type":"builtins.str"}},"__file__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__file__","name":"__file__","type":"builtins.str"}},"__name__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__name__","name":"__name__","type":"builtins.str"}},"__package__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__package__","name":"__package__","type":"builtins.str"}},"__spec__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.rotary_embedding.__spec__","name":"__spec__","type":"_frozen_importlib.ModuleSpec"}},"_apply_rotary_emb":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["x","cos","sin","is_neox_style"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._apply_rotary_emb","name":"_apply_rotary_emb","type":{".class":"CallableType","arg_kinds":[0,0,0,0],"arg_names":["x","cos","sin","is_neox_style"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor","builtins.bool"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_apply_rotary_emb","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_rotate_gptj":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["x"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._rotate_gptj","name":"_rotate_gptj","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["x"],"arg_types":["torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_rotate_gptj","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_rotate_neox":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["x"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._rotate_neox","name":"_rotate_neox","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["x"],"arg_types":["torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_rotate_neox","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_yarn_find_correction_dim":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,1,1],"arg_names":["num_rotations","dim","base","max_position_embeddings"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._yarn_find_correction_dim","name":"_yarn_find_correction_dim","type":{".class":"CallableType","arg_kinds":[0,0,1,1],"arg_names":["num_rotations","dim","base","max_position_embeddings"],"arg_types":["builtins.int","builtins.int","builtins.float","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_yarn_find_correction_dim","ret_type":"builtins.float","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_yarn_find_correction_range":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,1,1],"arg_names":["low_rot","high_rot","dim","base","max_position_embeddings"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._yarn_find_correction_range","name":"_yarn_find_correction_range","type":{".class":"CallableType","arg_kinds":[0,0,0,1,1],"arg_names":["low_rot","high_rot","dim","base","max_position_embeddings"],"arg_types":["builtins.int","builtins.int","builtins.int","builtins.float","builtins.int"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_yarn_find_correction_range","ret_type":{".class":"TupleType","implicit":false,"items":["builtins.int","builtins.int"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_yarn_get_mscale":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[1],"arg_names":["scale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._yarn_get_mscale","name":"_yarn_get_mscale","type":{".class":"CallableType","arg_kinds":[1],"arg_names":["scale"],"arg_types":["builtins.float"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_yarn_get_mscale","ret_type":"builtins.float","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"_yarn_linear_ramp_mask":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["low","high","dim","dtype"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding._yarn_linear_ramp_mask","name":"_yarn_linear_ramp_mask","type":{".class":"CallableType","arg_kinds":[0,0,0,0],"arg_names":["low","high","dim","dtype"],"arg_types":["builtins.float","builtins.float","builtins.int","torch._C.dtype"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_yarn_linear_ramp_mask","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"current_platform":{".class":"SymbolTableNode","cross_ref":"vllm.platforms.current_platform","kind":"Gdef"},"get_rope":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1,1,1,1],"arg_names":["head_size","rotary_dim","max_position","base","is_neox_style","rope_scaling","dtype","partial_rotary_factor"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.get_rope","name":"get_rope","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1,1,1,1],"arg_names":["head_size","rotary_dim","max_position","base","is_neox_style","rope_scaling","dtype","partial_rotary_factor"],"arg_types":["builtins.int","builtins.int","builtins.int","builtins.int","builtins.bool",{".class":"UnionType","items":[{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":2}],"extra_attrs":null,"type_ref":"builtins.dict"},{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._C.dtype",{".class":"NoneType"}],"uses_pep604_syntax":false},"builtins.float"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"get_rope","ret_type":"vllm.model_executor.layers.rotary_embedding.RotaryEmbedding","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"math":{".class":"SymbolTableNode","cross_ref":"math","kind":"Gdef"},"nn":{".class":"SymbolTableNode","cross_ref":"torch.nn","kind":"Gdef"},"torch":{".class":"SymbolTableNode","cross_ref":"torch","kind":"Gdef"},"yarn_get_mscale":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[1,1],"arg_names":["scale","mscale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.rotary_embedding.yarn_get_mscale","name":"yarn_get_mscale","type":{".class":"CallableType","arg_kinds":[1,1],"arg_names":["scale","mscale"],"arg_types":["builtins.float","builtins.float"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"yarn_get_mscale","ret_type":"builtins.float","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"path":"c:\\Users\\shivam\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\vllm\\model_executor\\layers\\rotary_embedding.py"}