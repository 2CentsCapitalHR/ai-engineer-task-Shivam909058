{".class":"MypyFile","_fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils","future_import_flags":[],"is_partial_stub_package":false,"is_stub":false,"names":{".class":"SymbolTable","CUTLASS_BLOCK_FP8_SUPPORTED":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.CUTLASS_BLOCK_FP8_SUPPORTED","name":"CUTLASS_BLOCK_FP8_SUPPORTED","type":"builtins.bool"}},"CUTLASS_FP8_SUPPORTED":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.CUTLASS_FP8_SUPPORTED","name":"CUTLASS_FP8_SUPPORTED","type":"builtins.bool"}},"CompilationLevel":{".class":"SymbolTableNode","cross_ref":"vllm.config.CompilationLevel","kind":"Gdef"},"Fp8LinearOp":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["builtins.object"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","name":"Fp8LinearOp","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"vllm.model_executor.layers.quantization.utils.w8a8_utils","mro":["vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1,1],"arg_names":["self","cutlass_fp8_supported","use_per_token_if_dynamic","pad_output"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.__init__","name":"__init__","type":{".class":"CallableType","arg_kinds":[0,1,1,1],"arg_names":["self","cutlass_fp8_supported","use_per_token_if_dynamic","pad_output"],"arg_types":["vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","builtins.bool","builtins.bool",{".class":"UnionType","items":["builtins.bool",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"__init__ of Fp8LinearOp","ret_type":{".class":"NoneType"},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"apply":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1,1,1,1,1],"arg_names":["self","input","weight","weight_scale","out_dtype","input_scale","input_scale_ub","bias","use_per_token_if_dynamic"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.apply","name":"apply","type":{".class":"CallableType","arg_kinds":[0,0,0,0,1,1,1,1,1],"arg_names":["self","input","weight","weight_scale","out_dtype","input_scale","input_scale_ub","bias","use_per_token_if_dynamic"],"arg_types":["vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","torch._tensor.Tensor","torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._C.dtype",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false},{".class":"UnionType","items":["builtins.bool",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"apply of Fp8LinearOp","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"cutlass_fp8_supported":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.cutlass_fp8_supported","name":"cutlass_fp8_supported","type":"builtins.bool"}},"output_padding":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.output_padding","name":"output_padding","type":{".class":"UnionType","items":["builtins.int",{".class":"NoneType"}],"uses_pep604_syntax":false}}},"use_per_token_if_dynamic":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.use_per_token_if_dynamic","name":"use_per_token_if_dynamic","type":"builtins.bool"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp.Self","id":0,"name":"Self","namespace":"","upper_bound":"vllm.model_executor.layers.quantization.utils.w8a8_utils.Fp8LinearOp","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"List":{".class":"SymbolTableNode","cross_ref":"typing.List","kind":"Gdef"},"Optional":{".class":"SymbolTableNode","cross_ref":"typing.Optional","kind":"Gdef"},"TORCH_DEVICE_IDENTITY":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.TORCH_DEVICE_IDENTITY","name":"TORCH_DEVICE_IDENTITY","type":{".class":"NoneType"}}},"Tuple":{".class":"SymbolTableNode","cross_ref":"typing.Tuple","kind":"Gdef"},"USE_ROWWISE_TORCH_SCALED_MM":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.USE_ROWWISE_TORCH_SCALED_MM","name":"USE_ROWWISE_TORCH_SCALED_MM","type":"builtins.bool"}},"Union":{".class":"SymbolTableNode","cross_ref":"typing.Union","kind":"Gdef"},"__annotations__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__annotations__","name":"__annotations__","type":{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"__doc__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__doc__","name":"__doc__","type":"builtins.str"}},"__file__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__file__","name":"__file__","type":"builtins.str"}},"__name__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__name__","name":"__name__","type":"builtins.str"}},"__package__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__package__","name":"__package__","type":"builtins.str"}},"__spec__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.__spec__","name":"__spec__","type":"_frozen_importlib.ModuleSpec"}},"all_close_1d":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["x"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.all_close_1d","name":"all_close_1d","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["x"],"arg_types":["torch._tensor.Tensor"],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"all_close_1d","ret_type":"builtins.bool","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"convert_to_channelwise":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["weight_scale","logical_widths"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.convert_to_channelwise","name":"convert_to_channelwise","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["weight_scale","logical_widths"],"arg_types":["torch._tensor.Tensor",{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"convert_to_channelwise","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"current_platform":{".class":"SymbolTableNode","cross_ref":"vllm.platforms.current_platform","kind":"Gdef"},"cutlass_block_fp8_supported":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.cutlass_block_fp8_supported","name":"cutlass_block_fp8_supported","type":{".class":"CallableType","arg_kinds":[],"arg_names":[],"arg_types":[],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"cutlass_block_fp8_supported","ret_type":"builtins.bool","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"cutlass_fp8_supported":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.cutlass_fp8_supported","name":"cutlass_fp8_supported","type":{".class":"CallableType","arg_kinds":[],"arg_names":[],"arg_types":[],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"cutlass_fp8_supported","ret_type":"builtins.bool","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"cutlass_group_gemm_supported":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.cutlass_group_gemm_supported","name":"cutlass_group_gemm_supported","type":{".class":"CallableType","arg_kinds":[],"arg_names":[],"arg_types":[],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"cutlass_group_gemm_supported","ret_type":"builtins.bool","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"get_current_vllm_config":{".class":"SymbolTableNode","cross_ref":"vllm.config.get_current_vllm_config","kind":"Gdef"},"maybe_create_device_identity":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.maybe_create_device_identity","name":"maybe_create_device_identity","type":null}},"normalize_e4m3fn_to_e4m3fnuz":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,1],"arg_names":["weight","weight_scale","input_scale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.normalize_e4m3fn_to_e4m3fnuz","name":"normalize_e4m3fn_to_e4m3fnuz","type":{".class":"CallableType","arg_kinds":[0,0,1],"arg_names":["weight","weight_scale","input_scale"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"normalize_e4m3fn_to_e4m3fnuz","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor",{".class":"UnionType","items":["torch._tensor.Tensor",{".class":"NoneType"}],"uses_pep604_syntax":false}],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"ops":{".class":"SymbolTableNode","cross_ref":"vllm._custom_ops","kind":"Gdef"},"per_tensor_dequantize":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["tensor","inv_scale"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.per_tensor_dequantize","name":"per_tensor_dequantize","type":{".class":"CallableType","arg_kinds":[0,0],"arg_names":["tensor","inv_scale"],"arg_types":["torch._tensor.Tensor",{".class":"UnionType","items":["builtins.float","torch._tensor.Tensor"],"uses_pep604_syntax":false}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"per_tensor_dequantize","ret_type":"torch._tensor.Tensor","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"requantize_with_max_scale":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0],"arg_names":["weight","weight_scale","logical_widths"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.requantize_with_max_scale","name":"requantize_with_max_scale","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["weight","weight_scale","logical_widths"],"arg_types":["torch._tensor.Tensor","torch._tensor.Tensor",{".class":"Instance","args":["builtins.int"],"extra_attrs":null,"type_ref":"builtins.list"}],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"requantize_with_max_scale","ret_type":{".class":"TupleType","implicit":false,"items":["torch._tensor.Tensor","torch._tensor.Tensor"],"partial_fallback":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.tuple"}},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"sparse_cutlass_supported":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"vllm.model_executor.layers.quantization.utils.w8a8_utils.sparse_cutlass_supported","name":"sparse_cutlass_supported","type":{".class":"CallableType","arg_kinds":[],"arg_names":[],"arg_types":[],"bound_args":[],"def_extras":{"first_arg":null},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"sparse_cutlass_supported","ret_type":"builtins.bool","type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}},"torch":{".class":"SymbolTableNode","cross_ref":"torch","kind":"Gdef"}},"path":"c:\\Users\\shivam\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\vllm\\model_executor\\layers\\quantization\\utils\\w8a8_utils.py"}